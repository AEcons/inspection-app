<!DOCTYPE html>
<html lang="th">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>สรุปรายงาน</title>
  <link rel="stylesheet" href="style.css" />
</head>
<body>
  <header>
    <h1>สรุปรายงานการตรวจงาน</h1>
  </header>

  <main>
    <section>
      <label>เลือกโครงการ:
        <select id="projectSelect" onchange="loadSummaryReport()">
          <option value="">-- แสดงทั้งหมด --</option>
        </select>
      </label>
    </section>

    <section>
      <table>
        <tr><th>จำนวนรายการทั้งหมด</th><td id="totalItems">0</td></tr>
        <tr><th>อยู่ระหว่างแก้ไข</th><td id="inProgress">0</td></tr>
        <tr><th>QC ผ่านแล้ว</th><td id="qcPass">0</td></tr>
        <tr><th>ลูกบ้านรับมอบ</th><td id="handover">0</td></tr>
        <tr><th>ยังไม่ระบุสถานะ</th><td id="pending">0</td></tr>
      </table>
    </section>

    <section>
      <h3>รายการยอดนิยม 3 อันดับ</h3>
      <ol id="topItems"></ol>
    </section>

    <section class="buttons">
      <button onclick="window.location.href='index.html'">กลับหน้าหลัก</button>
    </section>
  </main>

  <script src="app.js"></script>
  <script>
    function populateProjects() {
      const select = document.getElementById("projectSelect");
      const keys = Object.keys(localStorage);
      const projects = [...new Set(keys.map(k => k.split("_")[0]))];
      projects.forEach(p => {
        const opt = document.createElement("option");
        opt.value = p;
        opt.textContent = p;
        select.appendChild(opt);
      });
    }

    window.onload = () => {
      populateProjects();
      loadSummaryReport();
    };
  </script>
</body>
</html>

