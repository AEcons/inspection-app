<!DOCTYPE html>
<html lang="th">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>รายงานสรุป</title>
  <link rel="stylesheet" href="style.css" />
</head>
<body>
  <header>
    <h1>รายงานสรุปผลการตรวจงาน</h1>
  </header>

  <main>
    <label for="projectSelect">เลือกโครงการ:</label>
    <select id="projectSelect" onchange="loadSummaryReport()">
      <option value="">-- ทั้งหมด --</option>
    </select>

    <section class="summary">
      <p><strong>จำนวนรายการทั้งหมด:</strong> <span id="totalItems">0</span></p>
      <p><strong>อยู่ระหว่างแก้ไข:</strong> <span id="inProgress">0</span></p>
      <p><strong>QC ผ่านแล้ว:</strong> <span id="qcPass">0</span></p>
      <p><strong>ลูกบ้านรับมอบ:</strong> <span id="handover">0</span></p>
      <p><strong>ยังไม่ระบุสถานะ:</strong> <span id="pending">0</span></p>
    </section>

    <section>
      <h3>รายการที่ตรวจบ่อยที่สุด 3 อันดับ</h3>
      <ul id="topItems"></ul>
    </section>

    <section class="buttons">
      <button onclick="window.print()">พิมพ์ PDF</button>
      <button onclick="window.location.href='index.html'">กลับหน้าหลัก</button>
    </section>
  </main>

  <script src="app.js"></script>
  <script>
    function loadProjectSelect() {
      const keys = Object.keys(localStorage);
      const projects = [...new Set(keys.map(k => k.split("_")[0]))];
      const select = document.getElementById("projectSelect");

      projects.forEach(p => {
        const opt = document.createElement("option");
        opt.value = p;
        opt.textContent = p;
        select.appendChild(opt);
      });
    }

    window.onload = () => {
      loadProjectSelect();
      loadSummaryReport();
    };
  </script>
</body>
</html>
