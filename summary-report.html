<!DOCTYPE html>
<html lang="th">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>รายงานสรุป</title>
  <link rel="stylesheet" href="style.css" />
</head>
<body>
  <header>
    <h1>รายงานสรุป</h1>
    <p>ผู้ใช้งาน: <span id="displayUser"></span></p>
  </header>

  <main>
    <section>
      <label>เลือกโครงการ:
        <select id="projectSelect" onchange="loadSummaryReport()"></select>
      </label>
    </section>

    <section class="summary">
      <p>จำนวนรายการทั้งหมด: <strong id="totalItems">0</strong></p>
      <p>อยู่ระหว่างแก้ไข: <strong id="inProgress">0</strong></p>
      <p>QC ผ่านแล้ว: <strong id="qcPass">0</strong></p>
      <p>ลูกบ้านรับมอบ: <strong id="handover">0</strong></p>
      <p>ยังไม่ระบุสถานะ: <strong id="pending">0</strong></p>
    </section>

    <section>
      <h3>รายการยอดนิยม</h3>
      <ol id="topItems"></ol>
    </section>

    <div class="buttons">
      <button onclick="window.print()">พิมพ์รายงาน</button>
      <button onclick="window.location.href='index.html'">กลับหน้าหลัก</button>
    </div>
  </main>

  <script src="app.js"></script>
  <script>
    document.getElementById("displayUser").textContent = getUser();

    const projectSelect = document.getElementById("projectSelect");
    const keys = Object.keys(localStorage).filter(k => k.includes("_"));
    const projects = [...new Set(keys.map(k => k.split("_")[0]))];

    projectSelect.innerHTML = `<option value="">ทั้งหมด</option>` +
      projects.map(p => `<option value="${p}">${p}</option>`).join("");

    loadSummaryReport();
  </script>
</body>
</html>

