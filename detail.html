<!DOCTYPE html>
<html lang="th">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>รายละเอียดงาน</title>
  <link rel="stylesheet" href="style.css" />
</head>
<body>
  <header>
    <h1>รายละเอียดงานตรวจ</h1>
    <p>โครงการ: <span id="projectName"></span></p>
    <p>เลขแปลง: <span id="plotNumber"></span></p>
  </header>

  <main id="detailContainer"></main>

  <section class="signature">
    <div class="sign-left">
      <p>ลงชื่อผู้ควบคุมงาน</p>
      <br><br><br>
      <p>(................................................)</p>
    </div>
    <div class="sign-right">
      <p>ลงชื่อผู้จัดการโครงการ</p>
      <br><br><br>
      <p>(................................................)</p>
    </div>
  </section>

  <section class="buttons">
    <button onclick="window.print()">พิมพ์รายงาน</button>
    <button onclick="window.location.href='index.html'">กลับหน้าหลัก</button>
  </section>

  <script>
    function loadDetail() {
      const project = sessionStorage.getItem("selectedProject");
      const plot = sessionStorage.getItem("selectedPlot");
      document.getElementById("projectName").textContent = project;
      document.getElementById("plotNumber").textContent = plot;

      const key = `${project}_${plot}`;
      const records = JSON.parse(localStorage.getItem(key)) || [];
      const container = document.getElementById("detailContainer");
      container.innerHTML = "";

      if (records.length === 0) {
        container.innerHTML = "<p>ไม่พบข้อมูล</p>";
        return;
      }

      records.forEach((rec, i) => {
        const section = document.createElement("section");
        section.className = "record-detail";
        section.innerHTML = `
          <h3>รายการที่ ${i + 1}</h3>
          <p><strong>วันที่เริ่ม:</strong> ${rec.startDate || "-"}</p>
          <p><strong>วันที่เสร็จ:</strong> ${rec.endDate || "-"}</p>
          <p><strong>รายละเอียด:</strong> ${rec.item}</p>
          <p><strong>สถานะ:</strong> ${rec.status}</p>
          <div class="image-grid">
            <img src="${rec.before1}" alt="ก่อนทำ 1" />
            <img src="${rec.before2}" alt="ก่อนทำ 2" />
            <img src="${rec.after1}" alt="หลังทำ 1" />
            <img src="${rec.after2}" alt="หลังทำ 2" />
          </div>
          <hr/>
        `;
        container.appendChild(section);
      });
    }

    window.onload = loadDetail;
  </script>
</body>
</html>
