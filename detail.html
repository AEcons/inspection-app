<!DOCTYPE html>
<html lang="th">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡∏á‡∏≤‡∏ô</title>
  <link rel="stylesheet" href="style.css" />
  <style>
    .record-box {
      border: 1px solid #ccc;
      padding: 10px;
      margin: 12px 0;
    }
    .signature-section {
      display: flex;
      justify-content: space-between;
      margin-top: 50px;
    }
    .signature-box {
      width: 40%;
      text-align: center;
      border-top: 1px solid black;
      padding-top: 5px;
    }
  </style>
</head>
<body>
  <div class="container">
    <h2>‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡∏á‡∏≤‡∏ô‡πÇ‡∏Ñ‡∏£‡∏á‡∏Å‡∏≤‡∏£</h2>
    <div id="projectInfo"></div>
    <div id="recordsContainer"></div>

    <div class="signature-section">
      <div class="signature-box">‡∏ú‡∏π‡πâ‡∏Ñ‡∏ß‡∏ö‡∏Ñ‡∏∏‡∏°‡∏á‡∏≤‡∏ô</div>
      <div class="signature-box">‡∏ú‡∏π‡πâ‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡πÇ‡∏Ñ‡∏£‡∏á‡∏Å‡∏≤‡∏£</div>
    </div>

    <br />
    <div class="center">
      <button onclick="prevPage()">‚¨Ö ‡∏´‡∏ô‡πâ‡∏≤‡∏Å‡πà‡∏≠‡∏ô‡∏´‡∏ô‡πâ‡∏≤</button>
      <button onclick="nextPage()">‡∏´‡∏ô‡πâ‡∏≤‡∏ñ‡∏±‡∏î‡πÑ‡∏õ ‚û°</button>
    </div>
    <br />
    <div class="center">
      <button onclick="window.print()">üñ®Ô∏è ‡∏û‡∏¥‡∏°‡∏û‡πå‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô</button>
      <button onclick="window.location.href='index.html'">üîô ‡∏Å‡∏•‡∏±‡∏ö‡∏´‡∏ô‡πâ‡∏≤‡∏´‡∏•‡∏±‡∏Å</button>
    </div>
  </div>

  <script>
    const urlParams = new URLSearchParams(window.location.search);
    const project = urlParams.get("project");
    const plot = urlParams.get("plot");
    const key = `${project}_${plot}`;

    let currentPage = 0;
    const itemsPerPage = 5;
    let recordPages = [];

    function loadDetail() {
      const data = localStorage.getItem(key);
      if (!data) {
        document.getElementById("projectInfo").innerHTML = "<p>‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•</p>";
        return;
      }

      const rec = JSON.parse(data);
      document.getElementById("projectInfo").innerHTML = `
        <p><strong>‡πÇ‡∏Ñ‡∏£‡∏á‡∏Å‡∏≤‡∏£:</strong> ${rec.project}</p>
        <p><strong>‡πÅ‡∏õ‡∏•‡∏á:</strong> ${rec.plot}</p>
        <p><strong>‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡πÄ‡∏£‡∏¥‡πà‡∏°:</strong> ${rec.startDate}</p>
        <p><strong>‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡πÄ‡∏™‡∏£‡πá‡∏à:</strong> ${rec.endDate}</p>
        <p><strong>‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞:</strong> ${rec.status}</p>
      `;

      const itemList = [
        {
          item: rec.item,
          before1: rec.before1,
          before2: rec.before2,
          after1: rec.after1,
          after2: rec.after2,
        },
      ];

      // ‡πÄ‡∏ï‡∏£‡∏µ‡∏¢‡∏°‡πÅ‡∏ö‡πà‡∏á‡∏´‡∏ô‡πâ‡∏≤ (‡∏£‡∏≠‡∏á‡∏£‡∏±‡∏ö‡∏Å‡∏£‡∏ì‡∏µ‡πÉ‡∏ô‡∏≠‡∏ô‡∏≤‡∏Ñ‡∏ï‡∏°‡∏µ‡∏´‡∏•‡∏≤‡∏¢‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏ï‡πà‡∏≠‡πÅ‡∏õ‡∏•‡∏á)
      recordPages = [];
      for (let i = 0; i < itemList.length; i += itemsPerPage) {
        recordPages.push(itemList.slice(i, i + itemsPerPage));
      }

      renderPage();
    }

    function renderPage() {
      const container = document.getElementById("recordsContainer");
      container.innerHTML = "";
      const pageData = recordPages[currentPage];

      pageData.forEach((r, idx) => {
        const box = document.createElement("div");
        box.className = "record-box";
        box.innerHTML = `
          <p><strong>‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£:</strong> ${r.item}</p>
          <div style="display: flex; flex-wrap: wrap; gap: 10px;">
            <div><p>‡∏Å‡πà‡∏≠‡∏ô‡∏ó‡∏≥ 1:</p><img src="${r.before1}" width="100"/></div>
            <div><p>‡∏Å‡πà‡∏≠‡∏ô‡∏ó‡∏≥ 2:</p><img src="${r.before2}" width="100"/></div>
            <div><p>‡∏´‡∏•‡∏±‡∏á‡∏ó‡∏≥ 1:</p><img src="${r.after1}" width="100"/></div>
            <div><p>‡∏´‡∏•‡∏±‡∏á‡∏ó‡∏≥ 2:</p><img src="${r.after2}" width="100"/></div>
          </div>
        `;
        container.appendChild(box);
      });
    }

    function nextPage() {
      if (currentPage < recordPages.length - 1) {
        currentPage++;
        renderPage();
      }
    }

    function prevPage() {
      if (currentPage > 0) {
        currentPage--;
        renderPage();
      }
    }

    window.onload = loadDetail;
  </script>
</body>
</html>
