<!DOCTYPE html>
<html lang="th">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>‡∏´‡∏ô‡πâ‡∏≤‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î</title>
  <link rel="stylesheet" href="style.css">
</head>
<body>
  <h1>‡∏´‡∏ô‡πâ‡∏≤‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î</h1>
  <div id="detailHeader"></div>
  <div id="detailList"></div>
  <button onclick="location.href='report.html'">üîô ‡∏Å‡∏•‡∏±‡∏ö‡∏´‡∏ô‡πâ‡∏≤‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô</button>

  <script>
    const project = localStorage.getItem('aeSelectedProject');
    const plot = localStorage.getItem('aeSelectedPlot');
    const records = JSON.parse(localStorage.getItem('aeRecords') || '[]')
      .filter(r => r.project === project && r.plot === plot);

    document.getElementById('detailHeader').innerHTML = `<h3>‡πÇ‡∏Ñ‡∏£‡∏á‡∏Å‡∏≤‡∏£: ${project} - ‡πÅ‡∏õ‡∏•‡∏á: ${plot}</h3>`;

    document.getElementById('detailList').innerHTML = records.map((r, i) => `
      <div style="border:1px solid #ccc; margin:10px; padding:10px;">
        <b>${i + 1}.</b> ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£: ${r.description}<br>
        ‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà: ${r.startDate} ‡∏ñ‡∏∂‡∏á ${r.endDate || '-'}<br>
        ‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞: ${r.status}<br>
        ‡∏ú‡∏π‡πâ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å: ${r.user}<br>
        <div style="margin-top:5px;">
          <img src="${r.beforeImage || ''}" alt="‡∏£‡∏π‡∏õ‡∏Å‡πà‡∏≠‡∏ô‡∏ó‡∏≥" width="100" onerror="this.style.display='none'">
          <img src="${r.afterImage || ''}" alt="‡∏£‡∏π‡∏õ‡∏´‡∏•‡∏±‡∏á‡∏ó‡∏≥" width="100" onerror="this.style.display='none'">
        </div>
      </div>
    `).join('');
  </script>
</body>
</html>