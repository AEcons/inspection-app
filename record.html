<!DOCTYPE html>
<html lang="th">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>‡∏´‡∏ô‡πâ‡∏≤‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å</title>
  <link rel="stylesheet" href="style.css" />
</head>
<body>
  <h1>‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏á‡∏≤‡∏ô</h1>
  <form id="recordForm">
    <label>‡∏ä‡∏∑‡πà‡∏≠‡πÇ‡∏Ñ‡∏£‡∏á‡∏Å‡∏≤‡∏£: <input id="project" required></label>
    <label>‡πÄ‡∏•‡∏Ç‡πÅ‡∏õ‡∏•‡∏á: <input id="plot" required></label>
    <label>‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡πÄ‡∏£‡∏¥‡πà‡∏°: <input type="date" id="startDate" required></label>
    <label>‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡πÄ‡∏™‡∏£‡πá‡∏à: <input type="date" id="endDate"></label>
    <label>‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏á‡∏≤‡∏ô: <textarea id="description" required></textarea></label>
    <label>‡∏£‡∏π‡∏õ‡∏Å‡πà‡∏≠‡∏ô‡∏ó‡∏≥: <input type="text" id="beforeImage" placeholder="URL ‡∏£‡∏π‡∏õ‡∏Å‡πà‡∏≠‡∏ô‡∏ó‡∏≥" /></label>
    <label>‡∏£‡∏π‡∏õ‡∏´‡∏•‡∏±‡∏á‡∏ó‡∏≥: <input type="text" id="afterImage" placeholder="URL ‡∏£‡∏π‡∏õ‡∏´‡∏•‡∏±‡∏á‡∏ó‡∏≥" /></label>
    <label>‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞:
      <select id="status">
        <option value="‡∏≠‡∏¢‡∏π‡πà‡∏£‡∏∞‡∏´‡∏ß‡πà‡∏≤‡∏á‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç">‡∏≠‡∏¢‡∏π‡πà‡∏£‡∏∞‡∏´‡∏ß‡πà‡∏≤‡∏á‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç</option>
        <option value="QC ‡∏ú‡πà‡∏≤‡∏ô">QC ‡∏ú‡πà‡∏≤‡∏ô</option>
        <option value="‡∏•‡∏π‡∏Å‡∏ö‡πâ‡∏≤‡∏ô‡∏£‡∏±‡∏ö‡∏°‡∏≠‡∏ö">‡∏•‡∏π‡∏Å‡∏ö‡πâ‡∏≤‡∏ô‡∏£‡∏±‡∏ö‡∏°‡∏≠‡∏ö</option>
      </select>
    </label>
    <button type="submit">‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å</button>
  </form>
  <button onclick="location.href='index.html'">üîô ‡∏Å‡∏•‡∏±‡∏ö‡πÄ‡∏°‡∏ô‡∏π‡∏´‡∏•‡∏±‡∏Å</button>

  <script>
    const form = document.getElementById('recordForm');
    const user = localStorage.getItem('aeUser') || '-';

    form.onsubmit = async function(e) {
      e.preventDefault();
      const record = {
        project: form.project.value.trim(),
        plot: form.plot.value.trim(),
        startDate: form.startDate.value,
        endDate: form.endDate.value,
        description: form.description.value.trim(),
        beforeImage: form.beforeImage.value.trim(),
        afterImage: form.afterImage.value.trim(),
        status: form.status.value,
        user
      };
      const response = await fetch("https://script.google.com/macros/s/AKfycbz6TxFLY4L6kX15soOUBd-jRMY5cBB80jZtEDhJkkBq4TRLW6EhdmvxOPizJSo5w3jzHg/exec", {
        method: "POST",
        body: JSON.stringify([record]),
        headers: {
          "Content-Type": "application/json"
        }
      });
      const text = await response.text();
      alert(text);
      form.reset();
    };
  </script>
</body>
</html>